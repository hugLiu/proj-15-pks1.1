/*
 * LEAFLET.BOATMARKER
 * v1.0.0
 * Thomas BrÃ¼ggemann
 */
L.BoatIcon=L.Icon.extend({options:{iconSize:new L.Point(150,150),className:"leaflet-boat-icon",course:0,color:"#8ED6FF",labelAnchor:[23,0],wind:!1,windDirection:0,windSpeed:0},x:66,y:85,x_fac:.18,y_fac:.18,ctx:null,lastHeading:0,lastWindDirection:0,createIcon:function(){var t=document.createElement("canvas");this._setIconStyles(t,"icon");var i=this.options.iconSize;return t.width=i.x,t.height=i.y,this.ctx=t.getContext("2d"),this.draw(t.getContext("2d"),i.x,i.y),t},createShadow:function(){return null},draw:function(t,i,o){if(t){var n=this.x,e=this.y,s=this.x_fac,a=this.y_fac;if(t.clearRect(0,0,i,o),t.translate(i/2,o/2),t.rotate(this.options.course*Math.PI/180),t.translate(-i/2,-o/2),t.beginPath(),t.moveTo(n,e),t.bezierCurveTo(n,e+50*a,n+60*s,e+50*a,n+60*s,e),t.quadraticCurveTo(n+100*s,e-100*a,n+50*s,e-200*a),t.quadraticCurveTo(n,e-100*a,n,e),t.fillStyle=this.options.color,t.fill(),t.stroke(),t.closePath(),1==this.options.wind){t.translate(i/2,o/2),t.rotate(this.options.windDirection*Math.PI/180),t.translate(-i/2,-o/2),t.beginPath(),t.moveTo(i/2,e-45),t.lineTo(i/2,e-70);for(var r=i/2,c=5*Math.round(this.options.windSpeed/5),h=Math.floor(c/10),d=c%10>0,l=70,u=0;h>u;u++)t.moveTo(r,e-l),t.lineTo(r+8,e-l-8),l-=5;d&&(0==h&&(l-=5),t.moveTo(r,e-l),t.lineTo(r+5,e-l-5)),t.stroke()}}},setHeadingWind:function(t,i,o){this.options.wind=!0,this.options.course=t%360-this.lastHeading,this.lastHeading=t%360,this.options.windDirection=o%360-t%360,this.lastHeading+=this.options.windDirection,this.options.windSpeed=i;var n=this.options.iconSize;this.draw(this.ctx,n.x,n.y)},setHeading:function(t){this.options.course=t%360-this.lastHeading,this.lastHeading=t%360;var i=this.options.iconSize;this.draw(this.ctx,i.x,i.y)}}),L.BoatMarker=L.Marker.extend({setHeadingWind:function(t,i,o){this.options.icon.setHeadingWind(t,i,o)},setHeading:function(t){this.options.icon.setHeading(t)}}),L.boatMarker=function(t,i){var o="color"in i?i.color:"#f1c40f";return i.icon=new L.BoatIcon({color:o}),new L.BoatMarker(t,i)};
